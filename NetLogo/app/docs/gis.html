<!DOCTYPE html>
<title>
      NetLogo 6.0.2 User Manual: Gis Extension
    </title>
    <link rel="stylesheet" href="netlogo.css" type="text/css">
    <style type="text/css">
p { margin-left: 1.5em ; }
    h3 { font-size: 115% ; }
    h4 { font-size: 100% ; margin-left: 1.5em ; background: white ; }
    </style>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<h1>NetLogo Gis Extension</h1>
<h2><a href="#using" id="using" class="section-anchor">Using</a></h2>
<p>This extension adds GIS (Geographic Information Systems) support to
NetLogo. It provides the ability to load vector GIS data (points,
lines, and polygons), and raster GIS data (grids) into your model.</p>
<p>The extension supports vector data in the form of ESRI shapefiles.
The shapefile (.shp) format is the most common format for storing and
exchanging vector GIS data. The extension supports raster data in the
form of ESRI ASCII Grid files. The ASCII grid file (.asc or .grd) is
not as common as the shapefile, but is supported as an interchange
format by most GIS platforms.</p>
<h3><a href="#how-to-use" id="how-to-use" class="section-anchor">How to use</a></h3>
<p>In general, you first define a transformation between GIS data space
and NetLogo space, then load datasets and perform various operations
on them. The easiest way to define a transformation between GIS space
and NetLogo space is to take the union of the &ldquo;envelopes&rdquo;
or bounding rectangles of all of your datasets in GIS space and map
that directly to the bounds of the NetLogo world. See GIS General
Examples for an example of this technique.</p>
<p>You may also optionally define a projection for the GIS space, in
which case datasets will be re-projected to match that projection as
they are loaded, as long as each of your data files has an associated
.prj file that describes the projection or geographic coordinate
system of the data. If no associated .prj file is found, the
extension will assume that the dataset already uses the current
projection, regardless of what that projection is.</p>
<p>Once the coordinate system is defined, you can load datasets using
<a href="#gis:load-dataset">gis:load-dataset</a>. This primitive
reports either a VectorDataset or a RasterDataset, depending on what
type of file you pass it.</p>
<p>A VectorDataset consists of a collection of VectorFeatures, each one
of which is a point, line, or polygon, along with a set of property
values. A single VectorDataset may contain only one of the three
possible types of features.</p>
<p>There are several things you can do with a VectorDataset: ask it for
the names of the properties of its features, ask it for its
&ldquo;envelope&rdquo; (bounding rectangle), ask for a list of all
VectorFeatures in the dataset, search for a single VectorFeature or
list of VectorFeatures whose value for a particular property is less
than or greater than a particular value, or lies within a given
range, or matches a given string using wildcard matching
(&ldquo;*&rdquo;, which matches any number of occurrences of any
characters). If the VectorFeatures are polygons, you can also apply
the values of a particular property of the dataset&rsquo;s features to
a given patch variable.</p>
<p>There are also several things you can do with a VectorFeature from a
VectorDataset: ask it for a list of vertex lists, ask it for a
property value by name, ask it for its centroid (center of gravity),
and ask for a subset of a given agentset whose agents intersect the
given VectorFeature. For point data, each vertex list will be a
one-element list. For line data, each vertex list will represent the
vertices of a line that makes up that feature. For polygon data, each
vertex list will represent one &ldquo;ring&rdquo; of the polygon, and
the first and last vertex of the list will be the same. The vertex
lists are made up of values of type Vertex, and the centroid will be
a value of type Vertex as well.</p>
<p>There are a number of operations defined for RasterDatasets as well.
Mostly these involve sampling the values in the dataset, or
re-sampling a raster to a different resolution. You can also apply a
raster to a given patch variable, and convolve a raster using an
arbitrary convolution matrix.</p>
<blockquote>
<p><strong>Code Example:</strong> GIS General Examples has general examples of
how to use the extension</p>
<p><strong>Code Example:</strong> GIS Gradient Example is a more advanced
example of raster dataset analysis.</p>
</blockquote>
<h3><a href="#known-issues" id="known-issues" class="section-anchor">Known Issues</a></h3>
<p>Values of type RasterDataset, VectorDataset, VectorFeature, and
Vertex are not handled properly by <code>export-world</code> and
<code>import-world</code>. To save datasets, you must use the
<code>gis:store-dataset</code> primitive.</p>
<p>There is currently no way to distinguish positive-area
&ldquo;shell&rdquo; polygons from negative-area &ldquo;hole&rdquo;
polygons, or to determine which holes are associated with which
shells.</p>
<h3><a href="#credits" id="credits" class="section-anchor">Credits</a></h3>
<p>The primary developer of the GIS extension was Eric Russell.</p>
<p>The GIS extension makes use of several open-source software
libraries. For copyright and license information on those, see the
<a href="copyright.html">copyright</a> section of the manual. The
extension also contains elements borrowed from <a href="http://www.myworldgis.org" target="_blank">My World GIS</a>.</p>
<p>This documentation and the example NetLogo models are in the public
domain. The GIS extension itself is free and open source software.
See the README.md file in the extension/gis directory for details.</p>
<p>We would love to hear your suggestions on how to improve the GIS
extension, or just about what you&rsquo;re using it for. Post questions
and comments at the
<a href="http://groups.yahoo.com/group/netlogo-users/" target="_blank">NetLogo Users Group</a>, or write directly to Eric Russell and the NetLogo team at
<a href="mailto:ccl-gis@ccl.northwestern.edu">ccl-gis@ccl.northwestern.edu</a></p>
<h2>Primitives</h2>
<h3>RasterDataset Primitives</h3>
<div id="raster">
  <a href="#gis:width-of"><code>gis:width-of</code></a>
  <a href="#gis:height-of"><code>gis:height-of</code></a>
  <a href="#gis:raster-value"><code>gis:raster-value</code></a>
  <a href="#gis:set-raster-value"><code>gis:set-raster-value</code></a>
  <a href="#gis:minimum-of"><code>gis:minimum-of</code></a>
  <a href="#gis:maximum-of"><code>gis:maximum-of</code></a>
  <a href="#gis:sampling-method-of"><code>gis:sampling-method-of</code></a>
  <a href="#gis:set-sampling-method"><code>gis:set-sampling-method</code></a>
  <a href="#gis:raster-sample"><code>gis:raster-sample</code></a>
  <a href="#gis:raster-world-envelope"><code>gis:raster-world-envelope</code></a>
  <a href="#gis:create-raster"><code>gis:create-raster</code></a>
  <a href="#gis:resample"><code>gis:resample</code></a>
  <a href="#gis:convolve"><code>gis:convolve</code></a>
  <a href="#gis:apply-raster"><code>gis:apply-raster</code></a>
</div>
<h3>Dataset Primitives</h3>
<div id="data">
  <a href="#gis:load-dataset"><code>gis:load-dataset</code></a>
  <a href="#gis:store-dataset"><code>gis:store-dataset</code></a>
  <a href="#gis:type-of"><code>gis:type-of</code></a>
  <a href="#gis:patch-dataset"><code>gis:patch-dataset</code></a>
  <a href="#gis:turtle-dataset"><code>gis:turtle-dataset</code></a>
  <a href="#gis:link-dataset"><code>gis:link-dataset</code></a>
</div>
<h3>VectorDataset Primitives</h3>
<div id="vector">
  <a href="#gis:shape-type-of"><code>gis:shape-type-of</code></a>
  <a href="#gis:property-names"><code>gis:property-names</code></a>
  <a href="#gis:feature-list-of"><code>gis:feature-list-of</code></a>
  <a href="#gis:vertex-lists-of"><code>gis:vertex-lists-of</code></a>
  <a href="#gis:centroid-of"><code>gis:centroid-of</code></a>
  <a href="#gis:location-of"><code>gis:location-of</code></a>
  <a href="#gis:property-value"><code>gis:property-value</code></a>
  <a href="#gis:find-features"><code>gis:find-features</code></a>
  <a href="#gis:find-one-feature"><code>gis:find-one-feature</code></a>
  <a href="#gis:find-less-than"><code>gis:find-less-than</code></a>
  <a href="#gis:find-greater-than"><code>gis:find-greater-than</code></a>
  <a href="#gis:find-range"><code>gis:find-range</code></a>
  <a href="#gis:property-minimum"><code>gis:property-minimum</code></a>
  <a href="#gis:property-maximum"><code>gis:property-maximum</code></a>
  <a href="#gis:apply-coverage"><code>gis:apply-coverage</code></a>
  <a href="#gis:coverage-minimum-threshold"><code>gis:coverage-minimum-threshold</code></a>
  <a href="#gis:set-coverage-minimum-threshold"><code>gis:set-coverage-minimum-threshold</code></a>
  <a href="#gis:coverage-maximum-threshold"><code>gis:coverage-maximum-threshold</code></a>
  <a href="#gis:set-coverage-maximum-threshold"><code>gis:set-coverage-maximum-threshold</code></a>
  <a href="#gis:intersects?"><code>gis:intersects?</code></a>
  <a href="#gis:contains?"><code>gis:contains?</code></a>
  <a href="#gis:contained-by?"><code>gis:contained-by?</code></a>
  <a href="#gis:have-relationship?"><code>gis:have-relationship?</code></a>
  <a href="#gis:relationship-of"><code>gis:relationship-of</code></a>
  <a href="#gis:intersecting"><code>gis:intersecting</code></a>
</div>
<h3>Coordinate System Primitives</h3>
<div id="coord">
  <a href="#gis:set-transformation"><code>gis:set-transformation</code></a>
  <a href="#gis:set-transformation-ds"><code>gis:set-transformation-ds</code></a>
  <a href="#gis:set-world-envelope"><code>gis:set-world-envelope</code></a>
  <a href="#gis:set-world-envelope-ds"><code>gis:set-world-envelope-ds</code></a>
  <a href="#gis:world-envelope"><code>gis:world-envelope</code></a>
  <a href="#gis:envelope-of"><code>gis:envelope-of</code></a>
  <a href="#gis:envelope-union-of"><code>gis:envelope-union-of</code></a>
  <a href="#gis:load-coordinate-system"><code>gis:load-coordinate-system</code></a>
  <a href="#gis:set-coordinate-system"><code>gis:set-coordinate-system</code></a>
</div>
<h3>Drawing Primitives</h3>
<div id="drawing">
  <a href="#gis:drawing-color"><code>gis:drawing-color</code></a>
  <a href="#gis:set-drawing-color"><code>gis:set-drawing-color</code></a>
  <a href="#gis:draw"><code>gis:draw</code></a>
  <a href="#gis:fill"><code>gis:fill</code></a>
  <a href="#gis:paint"><code>gis:paint</code></a>
  <a href="#gis:import-wms-drawing"><code>gis:import-wms-drawing</code></a>
</div>
<div class="dict_entry" id="gis:set-transformation">
  <h3><a>gis:set-transformation</a></h3>
  <h4>
    <span class="prim_example">gis:set-transformation <i>gis-envelope</i> <i>netlogo-envelope</i></span>
  </h4>
<p>Defines a mapping between GIS coordinates and NetLogo coordinates.
The <em>gis-envelope</em> and <em>netlogo-envelope</em> parameters must
each be four-element lists consisting of:</p>
<pre><code>[minimum-x maximum-x minimum-y maximum-y]
</code></pre>
<p>The scale of the transformation will be equal to the minimum of the
scale necessary to make the mapping between the ranges of x values
and the scale necessary to make the mapping between the ranges of y
values. The GIS space will be centered in NetLogo space.</p>
<p>For example, the following two lists would map all of geographic
(latitude and longitude) space in degrees to NetLogo world space,
regardless of the current dimensions of the NetLogo world:</p>
<pre><code>(list -180 180 -90 90)
(list min-pxcor max-pxcor min-pycor max-pycor)
</code></pre>
<p>However, if you&rsquo;re setting the envelope of the NetLogo world,
you should probably be using <a href="#gis:set-world-envelope">set-world-envelope</a>.</p>
</div>
<div class="dict_entry" id="gis:set-transformation-ds">
  <h3><a>gis:set-transformation-ds</a></h3>
  <h4>
    <span class="prim_example">gis:set-transformation-ds <i>gis-envelope</i> <i>netlogo-envelope</i></span>
  </h4>
<p>Does the same thing as <a href="#gis:set-transformation">set-transformation</a> above, except that
it allows the scale for mapping the range of x values to be
different than the scale for y values. The &ldquo;-ds&rdquo; on the
end stands for &ldquo;different scales&rdquo;. Using different scales
will cause distortion of the shape of GIS features, and so it is
generally not recommended, but it may be useful for some models.</p>
<p>Here is an example of the difference between <a href="#gis:set-transformation">set-transformation</a> and <a href="#gis:set-transformation-ds">set-transformation-ds</a>:</p>
<table width="80%" border="1" rules="cols" style="border-collaps: separate; border-spacing: 4px; text-align: center; margin: 0 auto;">
<tr>
  <td style="padding: 8px">
    <img alt="" src="images/set-transformation.png" width="200">
  <td style="padding: 8px">
    <img alt="" src="images/set-transformation-ds.png" width="200">
  <tr>
  <td style="padding: 8px">
    Using [set-transformation](#gisset-transformation),
    the scale along the x and y axis is the same, preserving the
    round shape of the Earth in this Orthographic projection.
  <td style="padding: 8px">
    Using [set-transformation-ds](#gisset-transformation-ds), the
    scale along the x axis is stretched so that the earth covers
    the entire NetLogo View, which in this case distorts the shape
    of the Earth.
</table>
</div>
<div class="dict_entry" id="gis:set-world-envelope">
  <h3><a>gis:set-world-envelope</a></h3>
  <h4>
    <span class="prim_example">gis:set-world-envelope <i>gis-envelope</i></span>
  </h4>
<p>A shorthand for setting the transformation by mapping the envelope
of the NetLogo world to the given envelope in GIS space, while
keeping the scales along the x and y axis the same. It is
equivalent to:</p>
<pre><code>set-transformation gis-envelope (list min-pxcor max-pxcor min-pycor max-pycor)
</code></pre>
<p>This primitive is supplied because most of the time you&rsquo;ll want
to set the envelope of the entire NetLogo world, rather than just a
part of it.</p>
</div>
<div class="dict_entry" id="gis:set-world-envelope-ds">
  <h3><a>gis:set-world-envelope-ds</a></h3>
  <h4>
    <span class="prim_example">gis:set-world-envelope-ds <i>gis-envelope</i></span>
  </h4>
<p>A shorthand for setting the transformation by mapping the envelope
of the NetLogo world to the given envelope in GIS space, using
different scales along the x and y axis if necessary. It is
equivalent to:</p>
<pre><code>set-transformation-ds gis-envelope (list min-pxcor max-pxcor min-pycor max-pycor)
</code></pre>
<p>See the <a href="#transformation-example">pictures</a> above for
the difference between using equal scales for x and y coordinates
and using different scales.</p>
</div>
<div class="dict_entry" id="gis:world-envelope">
  <h3><a>gis:world-envelope</a></h3>
  <h4>
    <span class="prim_example">gis:world-envelope</span>
  </h4>
<p>Reports the envelope (bounding rectangle) of the NetLogo world,
transformed into GIS space. An envelope consists of a four-element
list of the form:</p>
<pre><code>[minimum-x maximum-x minimum-y maximum-y]
</code></pre>
</div>
<div class="dict_entry" id="gis:envelope-of">
  <h3><a>gis:envelope-of</a></h3>
  <h4>
    <span class="prim_example">gis:envelope-of <i>thing</i></span>
  </h4>
<p>Reports the envelope (bounding rectangle) of <em>thing</em> in GIS
coordinates. The <em>thing</em> may be an Agent, an AgentSet, a
RasterDataset, a VectorDataset, or a VectorFeature. An envelope
consists of a four-element list of the form:</p>
<pre><code>[minimum-x maximum-x minimum-y maximum-y]
</code></pre>
</div>
<div class="dict_entry" id="gis:envelope-union-of">
  <h3><a>gis:envelope-union-of</a></h3>
  <h4>
    <span class="prim_example">gis:envelope-union-of <i>envelope1</i> <i>envelope2</i></span>
    <span class="prim_example">gis:envelope-union-of <i>envelope1 ...</i></span>
  </h4>
<p>Reports an envelope (bounding rectangle) that entirely contains the
given envelopes. An envelope consists of a four-element list of the
form</p>
<pre><code>[minimum-x maximum-x minimum-y maximum-y]
</code></pre>
<p>No assumption is made about the coordinate system of the arguments,
though if they are not in the same coordinate system, results will
be unpredictable.</p>
</div>
<div class="dict_entry" id="gis:load-coordinate-system">
  <h3><a>gis:load-coordinate-system</a></h3>
  <h4>
    <span class="prim_example">gis:load-coordinate-system <i>file</i></span>
  </h4>
<p>Loads a new global projection used for projecting or re- projecting
GIS data as it is loaded from a file. The file must contain a valid
<a href="http://geoapi.sourceforge.net/2.0/javadoc/org/opengis/referencing/doc-files/WKT.html" target="_blank">
Well-Known Text (WKT)</a> projection description.</p>
<p>WKT projection files are frequently distributed alongside GIS data
files, and usually have a &ldquo;.prj&rdquo; filename extension.</p>
<p>Relative paths are resolved relative to the location of the current
model, or the user&rsquo;s home directory if the current model
hasn&rsquo;t been saved yet.</p>
<p>The GIS extension does not support all WKT coordinate systems and
projections. Only geographic (<code>&quot;GEOGCS&quot;</code>) and
projected (<code>&quot;PROJCS&quot;</code>) coordinate systems are
supported. For projected coordinate systems, only the following
projections are supported:</p>
<ul>
<li>Albers_Conic_Equal_Area</li>
<li>Lambert_Conformal_Conic_2SP</li>
<li>Polyconic</li>
<li>Lambert_Azimuthal_Equal_Area</li>
<li>Mercator_1SP</li>
<li>Robinson</li>
<li>Azimuthal_Equidistant</li>
<li>Miller</li>
<li>Stereographic</li>
<li>Cylindrical_Equal_Area</li>
<li>Oblique_Mercator</li>
<li>Transverse_Mercator</li>
<li>Equidistant_Conic</li>
<li>hotine_oblique_mercator</li>
<li>Gnomonic</li>
<li>Orthographic</li>
</ul>
<p>See <a href="http://remotesensing.org/geotiff/proj_list/" target="_blank">remotesensing.org</a>
for a complete list of WKT projections and their parameters.</p>
</div>
<div class="dict_entry" id="gis:set-coordinate-system">
  <h3><a>gis:set-coordinate-system</a></h3>
  <h4>
    <span class="prim_example">gis:set-coordinate-system <i>system</i></span>
  </h4>
<p>Sets the global projection used for projecting or re- projecting
GIS data as it is loaded. The <em>system</em> must be either a string
in <a href="http://geoapi.sourceforge.net/2.0/javadoc/org/opengis/referencing/doc-files/WKT.html" target="_blank">
Well-Known Text (WKT) format</a>, or a NetLogo list that consists
of WKT converted to a list by moving each keyword inside its
associated brackets and putting quotes around it. The latter is
preferred because it makes the code much more readable.</p>
<p>The same limitations on WKT support apply as described above in the
documentation for <a href="#gis:load-coordinate-system">load-coordinate-system</a></p>
</div>
<div class="dict_entry" id="gis:load-dataset">
  <h3><a>gis:load-dataset</a></h3>
  <h4>
    <span class="prim_example">gis:load-dataset <i>file</i></span>
  </h4>
<p>Loads the given data file, re-projecting the data as necessary if a
global projection is defined and if the data file itself has an
associated .prj file, then reports the resulting dataset.</p>
<p>If no &ldquo;.prj&rdquo; file is present, then <code>load-dataset</code>
assumes that the projection of the data being loaded is the same as
the current global coordinate system.</p>
<p>Relative paths are resolved relative to the location of the current
model, or the user&rsquo;s home directory if the current model
hasn&rsquo;t been saved yet.</p>
<p>Currently, two types of data file are supported:</p>
<ul>
<li>&ldquo;<strong>.shp</strong>&rdquo; (ESRI shapefile): contains vector data,
consisting of points, lines, or polygons. When the target file is a
shapefile, <code>load-dataset</code> reports a VectorDataset.</li>
<li>&ldquo;<strong>.asc</strong>&rdquo; or &ldquo;<strong>.grd</strong>&rdquo; (ESRI ASCII grid):
contains raster data, consisting of a grid of values. When
the target file is an ASCII grid file, <code>load-dataset</code>
reports a RasterDataset.</li>
</ul>
</div>
<div class="dict_entry" id="gis:store-dataset">
  <h3><a>gis:store-dataset</a></h3>
  <h4>
    <span class="prim_example">gis:store-dataset <i>dataset</i> <i>file</i></span>
  </h4>
<p>Saves the given dataset to the given file. If the name of the file
does not have the proper file extension, the extension will be
automatically appended to the name. Relative paths are resolved
relative to the location of the current model, or the user&rsquo;s
home directory if the current model hasn&rsquo;t been saved yet.</p>
<p>Currently, this primitive only works for RasterDatasets, and it can
only save those datasets as ESRI ASCII grid files.</p>
</div>
<div class="dict_entry" id="gis:type-of">
  <h3><a>gis:type-of</a></h3>
  <h4>
    <span class="prim_example">gis:type-of <i>dataset</i></span>
  </h4>
<p>Reports the type of the given GIS dataset: either &ldquo;VECTOR&rdquo; or &ldquo;RASTER&rdquo;</p>
</div>
<div class="dict_entry" id="gis:patch-dataset">
  <h3><a>gis:patch-dataset</a></h3>
  <h4>
    <span class="prim_example">gis:patch-dataset <i>patch-variable</i></span>
  </h4>
<p>Reports a new raster whose cells correspond directly to NetLogo
patches, and whose cell values consist of the values of the given
patch variable. This primitive is basically the inverse of <a href="#gis:apply-raster">apply-raster</a>;
<code>apply-raster</code> copies values from a raster dataset to a patch variable, while this
primitive copies values from a patch variable to a raster dataset.</p>
</div>
<div class="dict_entry" id="gis:turtle-dataset">
  <h3><a>gis:turtle-dataset</a></h3>
  <h4>
    <span class="prim_example">gis:turtle-dataset <i>turtle-set</i></span>
  </h4>
<p>Reports a new, point VectorDataset built from the turtles in the
given agentset. The points are located at locations of the turtles,
translated from NetLogo space into GIS space using the current
coordinate transformation. And the dataset&rsquo;s properties consist
of all of the turtle variables common to every turtle in the
agentset.</p>
</div>
<div class="dict_entry" id="gis:link-dataset">
  <h3><a>gis:link-dataset</a></h3>
  <h4>
    <span class="prim_example">gis:link-dataset <i>link-set</i></span>
  </h4>
<p>Reports a new, line VectorDataset built from the links in the given
agentset. The endpoints of each line are at the location of the
turtles connected by each link, translated from NetLogo space into
GIS space using the current coordinate transformation. And the
dataset&rsquo;s properties consist of all of the link variables
common to every link in the agentset.</p>
</div>
<div class="dict_entry" id="gis:shape-type-of">
  <h3><a>gis:shape-type-of</a></h3>
  <h4>
    <span class="prim_example">gis:shape-type-of <i>VectorDataset</i></span>
  </h4>
<p>Reports the shape type of the given dataset. The possible output
values are &ldquo;POINT&rdquo;, &ldquo;LINE&rdquo;, and &ldquo;POLYGON&rdquo;.</p>
</div>
<div class="dict_entry" id="gis:property-names">
  <h3><a>gis:property-names</a></h3>
  <h4>
    <span class="prim_example">gis:property-names <i>VectorDataset</i></span>
  </h4>
<p>Reports a list of strings where each string is the name of a
property possessed by each VectorFeature in the given
VectorDataset, suitable for use in <a href="#gis:property-value">gis:property-value</a>.</p>
</div>
<div class="dict_entry" id="gis:feature-list-of">
  <h3><a>gis:feature-list-of</a></h3>
  <h4>
    <span class="prim_example">gis:feature-list-of <i>VectorDataset</i></span>
  </h4>
<p>Reports a list of all VectorFeatures in the given dataset.</p>
</div>
<div class="dict_entry" id="gis:vertex-lists-of">
  <h3><a>gis:vertex-lists-of</a></h3>
  <h4>
    <span class="prim_example">gis:vertex-lists-of <i>VectorFeature</i></span>
  </h4>
<p>Reports a list of lists of Vertex values. For point datasets, each
vertex list will contain exactly one vertex: the location of a
point. For line datasets, each vertex list will contain at least
two points, and will represent a &ldquo;polyline&rdquo;, connecting
each adjacent pair of vertices in the list. For polygon datasets,
each vertex list will contain at least three points, representing a
polygon connecting each vertex, and the first and last vertices in
the list will be the same.</p>
</div>
<div class="dict_entry" id="gis:centroid-of">
  <h3><a>gis:centroid-of</a></h3>
  <h4>
    <span class="prim_example">gis:centroid-of <i>VectorFeature</i></span>
  </h4>
<p>Reports a single Vertex representing the centroid (center of
gravity) of the given feature. For point datasets, the centroid is
defined as the average location of all points in the feature. For
line datasets, the centroid is defined as the average of the
locations of the midpoints of all line segments in the feature,
weighted by segment length. For polygon datasets, the centroid is
defined as the weighted sum of the centroids of a decomposition of
the area into (possibly overlapping) triangles. See <a href="http://www.faqs.org/faqs/graphics/algorithms-faq/" target="_blank">this FAQ</a>
for more details on the polygon centroid algorithm.</p>
</div>
<div class="dict_entry" id="gis:location-of">
  <h3><a>gis:location-of</a></h3>
  <h4>
    <span class="prim_example">gis:location-of <i>Vertex</i></span>
  </h4>
<p>Reports a two-element list containing the x and y values (in that
order) of the given vertex translated into NetLogo world space
using the current transformation, or an empty list if the given
vertex lies outside the NetLogo world.</p>
</div>
<div class="dict_entry" id="gis:property-value">
  <h3><a>gis:property-value</a></h3>
  <h4>
    <span class="prim_example">gis:property-value <i>VectorFeature</i> <i>property-name</i></span>
  </h4>
<p>Reports the value of the property with the given name for the given
VectorDataset. The reported value may be a number, a string, or a
boolean value, depending on the type of the field in the underlying
data file.</p>
<p>For shapefiles, values from dBase <code>CHARACTER</code> and
<code>DATE</code> fields are returned as strings, values from
<code>NUMBER</code> and <code>FLOAT</code> fields are returned as numbers,
and values from <code>LOGICAL</code> fields are returned as boolean
values. <code>MEMO</code> fields are not supported. <code>DATE</code>
values are converted to strings using ISO 8601 format
(<code>YYYY-MM-DD</code>).</p>
</div>
<div class="dict_entry" id="gis:find-features">
  <h3><a>gis:find-features</a></h3>
  <h4>
    <span class="prim_example">gis:find-features <i>VectorDataset</i> <i>property-name</i> <i>specified-value</i></span>
  </h4>
<p>Reports a list of all VectorFeatures in the given dataset whose
value for the property <em>property-name</em> matches <em>specified-value</em> (a string).
Value comparison is not case sensitive, and the wildcard
character &ldquo;*&rdquo; will match any number of occurrences
(including zero) of any character.</p>
</div>
<div class="dict_entry" id="gis:find-one-feature">
  <h3><a>gis:find-one-feature</a></h3>
  <h4>
    <span class="prim_example">gis:find-one-feature <i>VectorDataset</i> <i>property-name</i> <i>specified-value</i></span>
  </h4>
<p>Reports the first VectorFeature in the dataset whose value for the
property <em>property-name</em> matches the given string. Value
comparison is not case sensitive, and the wildcard character
&ldquo;*&rdquo; will match any number of occurrences (including zero)
of any character. Features are searched in the order that they
appear in the data file that was the source of the dataset, and
searching stops as soon as a match is found. Reports
<code>nobody</code> if no matching VectorFeature is found.</p>
</div>
<div class="dict_entry" id="gis:find-less-than">
  <h3><a>gis:find-less-than</a></h3>
  <h4>
    <span class="prim_example">gis:find-less-than <i>VectorDataset</i> <i>property-name</i> <i>value</i></span>
  </h4>
<p>Reports a list of all VectorFeatures in the given dataset whose
value for the property <em>property-name</em> is less than the given
<em>value</em>. String values are compared using case-sensitive
lexicographic order as defined in the <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#compareTo(java.lang.String)" target="_blank">
Java Documentation</a>. Using a string value for a numeric property
or a numeric value for a string property will cause an error.</p>
</div>
<div class="dict_entry" id="gis:find-greater-than">
  <h3><a>gis:find-greater-than</a></h3>
  <h4>
    <span class="prim_example">gis:find-greater-than <i>VectorDataset</i> <i>property-name</i> <i>value</i></span>
  </h4>
<p>Reports a list of all VectorFeatures in the given dataset whose
value for the property <em>property-name</em> is greater than the
given <em>value</em>. String values are compared using case-sensitive
lexicographic order as defined in the <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#compareTo(java.lang.String)" target="_blank">
Java Documentation</a>. Using a string value for a numeric property
or a numeric value for a string property will cause an error.</p>
</div>
<div class="dict_entry" id="gis:find-range">
  <h3><a>gis:find-range</a></h3>
  <h4>
    <span class="prim_example">gis:find-range <i>VectorDataset</i> <i>property-name</i> <i>minimum-value</i> <i>maximum-value</i></span>
  </h4>
<p>Reports a list of all VectorFeatures in the given dataset whose
value for the property <em>property-name</em> is strictly greater
than <em>minimum-value</em> and strictly less than
<em>maximum-value</em>. String values are compared using
case-sensitive lexicographic order as defined in the <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#compareTo(java.lang.String)" target="_blank">
Java Documentation</a>. Using a string value for a numeric property
or a numeric value for a string property will cause an error.</p>
</div>
<div class="dict_entry" id="gis:property-minimum">
  <h3><a>gis:property-minimum</a></h3>
  <h4>
    <span class="prim_example">gis:property-minimum <i>VectorDataset</i> <i>property-name</i></span>
  </h4>
<p>Reports the smallest value for the given property over all of the
VectorFeatures in the given dataset. String values are compared
using case-sensitive lexicographic order as defined in the <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#compareTo(java.lang.String)" target="_blank">
Java Documentation</a>.</p>
</div>
<div class="dict_entry" id="gis:property-maximum">
  <h3><a>gis:property-maximum</a></h3>
  <h4>
    <span class="prim_example">gis:property-maximum <i>VectorDataset</i> <i>property-name</i></span>
  </h4>
<p>Reports the largest value for the given property over all of the
VectorFeatures in the given dataset. String values are compared
using case-sensitive lexicographic order as defined in the <a href="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#compareTo(java.lang.String)" target="_blank">
Java Documentation</a>.</p>
</div>
<div class="dict_entry" id="gis:apply-coverage">
  <h3><a>gis:apply-coverage</a></h3>
  <h4>
    <span class="prim_example">gis:apply-coverage <i>VectorDataset</i> <i>property-name</i> <i>patch-variable</i></span>
  </h4>
<p>Copies values from the given property of the VectorDataset&rsquo;s
features to the given patch variable. The dataset must be a
<code>polygon</code> dataset; points and lines are not supported.</p>
<p>For each patch, it finds all VectorFeatures that intersect that
patch. Then, if the property is a string property, it computes the
majority value by computing the total area of the patch covered by
VectorFeatures having each possible value of the property, then
returning the value which represents the largest proportion of the
patch area. If the property is a numeric property, it computes a
weighted average of property values from all VectorFeatures which
intersect the patch, weighted by the proportion of the patch area
they cover.</p>
<p>There are two exceptions to this default behavior:</p>
<ul>
<li>
<p>If a percentage of a patches&rsquo; area greater than the
coverage-maximum-threshold is covered by a single VectorFeature,
then the property value from that VectorFeature is copied directly.
If more than one VectorFeature covers a percentage of area greater
than the threshold, only the first will be used.</p>
</li>
<li>
<p>If the total percentage of a patches&rsquo; area covered by
VectorFeatures is less than the coverage-minimum-threshold, the
target patch variable is set to Not A Number.</p>
</li>
</ul>
<p>By default, the minimum threshold is 10% and the maximum threshold
is 33%. These values may be modified using the four primitives that
follow.</p>
</div>
<div class="dict_entry" id="gis:coverage-minimum-threshold">
  <h3><a>gis:coverage-minimum-threshold</a></h3>
  <h4>
    <span class="prim_example">gis:coverage-minimum-threshold</span>
  </h4>
<p>Reports the current coverage minimum threshold used by <a href="#gis:apply-coverage">gis:apply-coverage</a>.</p>
</div>
<div class="dict_entry" id="gis:set-coverage-minimum-threshold">
  <h3><a>gis:set-coverage-minimum-threshold</a></h3>
  <h4>
    <span class="prim_example">gis:set-coverage-minimum-threshold <i>new-threshold</i></span>
  </h4>
<p>Sets the current coverage minimum threshold to be used by <a href="#gis:apply-coverage">gis:apply-coverage</a>.</p>
</div>
<div class="dict_entry" id="gis:coverage-maximum-threshold">
  <h3><a>gis:coverage-maximum-threshold</a></h3>
  <h4>
    <span class="prim_example">gis:coverage-maximum-threshold</span>
  </h4>
<p>Reports the current coverage maximum threshold used by <a href="#gis:apply-coverage">gis:apply-coverage</a>.</p>
</div>
<div class="dict_entry" id="gis:set-coverage-maximum-threshold">
  <h3><a>gis:set-coverage-maximum-threshold</a></h3>
  <h4>
    <span class="prim_example">gis:set-coverage-maximum-threshold <i>new-threshold</i></span>
  </h4>
<p>Sets the current coverage maximum threshold to be used by <a href="#gis:apply-coverage">gis:apply-coverage</a>.</p>
</div>
<div class="dict_entry" id="gis:intersects?">
  <h3><a>gis:intersects?</a></h3>
  <h4>
    <span class="prim_example">gis:intersects? <i>x</i> <i>y</i></span>
  </h4>
<p>Reports true if the given objects&rsquo; spatial representations
share at least one point in common, and false otherwise. The
objects x and y may be any one of:</p>
<ul>
<li>a VectorDataset, in which case the object&rsquo;s spatial
representation is the union of all the points, lines, or polygons
the dataset contains.</li>
<li>a VectorFeature, in which case the object&rsquo;s spatial
representation is defined by the point, line, or polygon the
feature contains.</li>
<li>A turtle, in which case the spatial representation is a point.</li>
<li>A link, whose spatial representation is a line segment
connecting the two points represented by the turtles the link is
connecting.</li>
<li>A patch, whose spatial representation is a rectangular polygon.</li>
<li>An agentset, whose spatial representation is the union of the
representations of all of the agents it contains.</li>
<li>A list containing of any of the items listed here, including
another list. The spatial representation of such a list is the
union of the spatial representations of its contents.</li>
</ul>
</div>
<div class="dict_entry" id="gis:contains?">
  <h3><a>gis:contains?</a></h3>
  <h4>
    <span class="prim_example">gis:contains? <i>x</i> <i>y</i></span>
  </h4>
<p>Reports true if every point of <em>y</em>&rsquo;s spatial
representation is also a part of <em>x</em>&rsquo;s spatial
representation. Note that this means that polygons do contain their
boundaries. The objects x and y may be any one of</p>
<ul>
<li>a VectorDataset, in which case the object&rsquo;s spatial
representation is the union of all the points, lines, or polygons
the dataset contains.</li>
<li>a VectorFeature, in which case the object&rsquo;s spatial
representation is defined by the point, line, or polygon the
feature contains.</li>
<li>A turtle, in which case the spatial representation is a point.</li>
<li>A link, whose spatial representation is a line segment
connecting the two points represented by the turtles the link is
connecting.</li>
<li>A patch, whose spatial representation is a rectangular polygon.</li>
<li>An agentset, whose spatial representation is the union of the
representations of all of the agents it contains.</li>
<li>A list containing of any of the items listed here, including
another list. The spatial representation of such a list is the
union of the spatial representations of its contents.</li>
</ul>
</div>
<div class="dict_entry" id="gis:contained-by?">
  <h3><a>gis:contained-by?</a></h3>
  <h4>
    <span class="prim_example">gis:contained-by? <i>x</i> <i>y</i></span>
  </h4>
<p>Reports true if every point of <em>x</em>&rsquo;s spatial
representation is also a part of <em>y</em>&rsquo;s spatial
representation. The objects x and y may be any one of:</p>
<ul>
<li>a VectorDataset, in which case the object&rsquo;s spatial
representation is the union of all the points, lines, or polygons
the dataset contains.</li>
<li>a VectorFeature, in which case the object&rsquo;s spatial
representation is defined by the point, line, or polygon the
feature contains.</li>
<li>A turtle, in which case the spatial representation is a point.</li>
<li>A link, whose spatial representation is a line segment
connecting the two points represented by the turtles the link is
connecting.</li>
<li>A patch, whose spatial representation is a rectangular polygon.</li>
<li>An agentset, whose spatial representation is the union of the
representations of all of the agents it contains.</li>
<li>A list containing of any of the items listed here, including
another list. The spatial representation of such a list is the
union of the spatial representations of its contents.</li>
</ul>
</div>
<div class="dict_entry" id="gis:have-relationship?">
  <h3><a>gis:have-relationship?</a></h3>
  <h4>
    <span class="prim_example">gis:have-relationship? <i>x</i> <i>y</i></span>
  </h4>
<p>Reports true if the spatial representations of the two objects have
the given spatial relationship, and false otherwise. The spatial
relationship is specified using a <strong>Dimensionally Extended Nine-
Intersection Model (DE-9IM)</strong> matrix. The matrix consists of 9
elements, each of which specifies the required relationship between
the two objects&rsquo; interior space, boundary space, or exterior
space. The elements must have one of six possible values:</p>
<ul>
<li>&ldquo;T&rdquo;, meaning the spaces must intersect in some way</li>
<li>&ldquo;F&rdquo;, meaning the spaces must not intersect in any way</li>
<li>&ldquo;0&rdquo;, meaning the dimension of the spaces&rsquo;
intersection must be zero (i.e., it must be a point or non-empty
set of points).</li>
<li>&ldquo;1&rdquo;, meaning the dimension of the spaces&rsquo;
intersection must be one (i.e., it must be a line or non-empty set
of line segments).</li>
<li>&ldquo;2&rdquo;, meaning the dimension of the spaces&rsquo;
intersection must be two (i.e., it must be a polygon or set of
polygons whose area is greater than zero).</li>
<li>&ldquo;*&rdquo;, meaning that the two spaces may have any
relationship.</li>
</ul>
<p>For example, this matrix:
<table width="50%" border="1" style="text-align: center; margin: 0 auto;"></p>
<tr>
  <td rowspan="2" colspan="2">
  <td colspan="3">
    x
  <tr>
  <td> Interior <td> Boundary <td> Exterior <tr>
  <td rowspan="3">
    y
  <td> Interior <td> T <td> * <td> * <tr>
  <td> Boundary <td> * <td> * <td> * <tr>
  <td> Exterior <td> F <td> F <td> * </table>
<p>would return true if and only if some part of object <em>x</em>&rsquo;s
interior lies inside object <em>y</em>&rsquo;s interior, and no part of
object <em>x</em>&rsquo;s interior or boundary intersects object
<em>y</em>&rsquo;s exterior. This is essentially a more restrictive
form of the <code>contains?</code> primitive; one in which polygons are
not considered to contain their boundaries.</p>
<p>The matrix is given to the <code>have-relationship?</code> primitive as
a string, whose elements are given in the following order:
<table width="25%" border="1" style="text-align: center; margin: 0 auto;" align="center"></p>
<tr>
  <td> 1 <td> 2 <td> 3 <tr>
  <td> 4 <td> 5 <td> 6 <tr>
  <td> 7 <td> 8 <td> 9 </table>
<p>So to use the example matrix above, you would write:</p>
<pre><code>gis:have-relationship? x y &quot;T*****FF*&quot;
</code></pre>
<p>A much more detailed and formal description of the DE-9IM matrix
and the associated point-set theory can be found in the <a href="http://www.opengeospatial.org/standards/sfs" target="_blank">OpenGIS Simple
Features Specification for SQL</a>.</p>
<p>The objects x and y may be any one of:</p>
<ul>
<li>a VectorDataset, in which case the object&rsquo;s spatial
representation is the union of all the points, lines, or polygons
the dataset contains.</li>
<li>a VectorFeature, in which case the object&rsquo;s spatial
representation is defined by the point, line, or polygon the
feature contains.</li>
<li>A turtle, in which case the spatial representation is a point.</li>
<li>A link, whose spatial representation is a line segment
connecting the two points represented by the turtles the link is
connecting.</li>
<li>A patch, whose spatial representation is a rectangular polygon.</li>
<li>An agentset, whose spatial representation is the union of the
representations of all of the agents it contains.</li>
<li>A list containing of any of the items listed here, including
another list. The spatial representation of such a list is the
union of the spatial representations of its contents.</li>
</ul>
</div>
<div class="dict_entry" id="gis:relationship-of">
  <h3><a>gis:relationship-of</a></h3>
  <h4>
    <span class="prim_example">gis:relationship-of <i>x</i> <i>y</i></span>
  </h4>
<p>Reports the <strong>Dimensionally Extended Nine-Intersection Model
(DE-9IM)</strong> matrix that describes the spatial relationship of the
two objects. The matrix consists of 9 elements, each of which
describes the relationship between the two objects&rsquo; interior
space, boundary space, or exterior space. Each element will
describe the dimension of the intersection of two spaces, meaning
that it may have one of four possible values:</p>
<ul>
<li>&ldquo;-1&rdquo;, meaning the spaces do not intersect</li>
<li>&ldquo;0&rdquo;, meaning the dimension of the spaces&rsquo;
intersection is zero (i.e., they intersect at a point or set of
points).</li>
<li>&ldquo;1&rdquo;, meaning the dimension of the spaces&rsquo;
intersection is one (i.e., they intersect along one or more lines).</li>
<li>&ldquo;2&rdquo;, meaning the dimension of the spaces&rsquo;
intersection is two (i.e., their intersection is a non-empty
polygon).</li>
</ul>
<p>For example, the two polygons x and y shown here:</p>
<center>
  <img alt="" src="images/intersecting-polygons.png">
</center>
<p>have the following DE-9IM matrix:</p>
<table width="50%" border="1" style="text-align: center; margin: 0 auto;" align="center">
  <tr>
  <td rowspan="2" colspan="2">
  <td colspan="3">
    x
  <tr>
  <td> Interior <td> Boundary <td> Exterior <tr>
  <td rowspan="3">
    y
  <td> Interior <td> 2 <td> 1 <td> 2 <tr>
  <td> Boundary <td> 1 <td> 0 <td> 1 <tr>
  <td> Exterior <td> 2 <td> 1 <td> 2 </table>
<p>Which would be reported by the <code>relationship-of</code> primitive
as the string &ldquo;212101212&rdquo;.</p>
<p>A much more detailed and formal description of the DE-9IM matrix
and the associated point-set theory can be found in the <a href="http://www.opengeospatial.org/standards/sfs" target="_blank">OpenGIS Simple
Features Specification for SQL</a>.</p>
<p>The objects x and y may be any one of:</p>
<ul>
<li>a VectorDataset, in which case the object&rsquo;s spatial
representation is the union of all the points, lines, or polygons
the dataset contains.</li>
<li>a VectorFeature, in which case the object&rsquo;s spatial
representation is defined by the point, line, or polygon the
feature contains.</li>
<li>A turtle, in which case the spatial representation is a point.</li>
<li>A link, whose spatial representation is a line segment
connecting the two points represented by the turtles the link is
connecting.</li>
<li>A patch, whose spatial representation is a rectangular polygon.</li>
<li>An agentset, whose spatial representation is the union of the
representations of all of the agents it contains.</li>
<li>A list containing of any of the items listed here, including
another list. The spatial representation of such a list is the
union of the spatial representations of its contents.</li>
</ul>
</div>
<div class="dict_entry" id="gis:intersecting">
  <h3><a>gis:intersecting</a></h3>
  <h4>
    <span class="prim_example"><i>patch-set</i> gis:intersecting <i>data</i></span>
  </h4>
<p>Reports a new agent set containing only those members of the given
agent set which intersect given GIS <em>data</em>, which may be any
one of: a VectorDataset, a VectorFeature, an Agent, an Agent Set,
or a list containing any of the above.</p>
</div>
<div class="dict_entry" id="gis:width-of">
  <h3><a>gis:width-of</a></h3>
  <h4>
    <span class="prim_example">gis:width-of <i>RasterDataset</i></span>
  </h4>
<p>Reports the number of columns in the dataset. Note that this is the
number of cells from left to right, not the width of the dataset in
GIS space.</p>
</div>
<div class="dict_entry" id="gis:height-of">
  <h3><a>gis:height-of</a></h3>
  <h4>
    <span class="prim_example">gis:height-of <i>RasterDataset</i></span>
  </h4>
<p>Reports the number of rows in the dataset. Note that this is the
number of cells from top to bottom, not the height of the dataset
in GIS space.</p>
</div>
<div class="dict_entry" id="gis:raster-value">
  <h3><a>gis:raster-value</a></h3>
  <h4>
    <span class="prim_example">gis:raster-value <i>RasterDataset</i> <i>x</i> <i>y</i></span>
  </h4>
<p>Reports the value of the given raster dataset in the given cell.
Cell coordinates are numbered from left to right, and from top to
bottom, beginning with zero. So the upper left cell is (0, 0), and
the bottom right cell is (<code>gis:width-of dataset</code> - 1,
<code>gis:height-of dataset</code> - 1).</p>
</div>
<div class="dict_entry" id="gis:set-raster-value">
  <h3><a>gis:set-raster-value</a></h3>
  <h4>
    <span class="prim_example">gis:set-raster-value <i>RasterDataset</i> <i>x</i> <i>y</i> <i>value</i></span>
  </h4>
<p>Sets the value of the given raster dataset at the given cell to a
new value. Cell coordinates are numbered from left to right, and
from top to bottom, beginning with zero. So the upper left cell is
(0, 0), and the bottom right cell is (<code>gis:width-of dataset</code>
- 1, <code>gis:height-of dataset</code> - 1).</p>
</div>
<div class="dict_entry" id="gis:minimum-of">
  <h3><a>gis:minimum-of</a></h3>
  <h4>
    <span class="prim_example">gis:minimum-of <i>RasterDataset</i></span>
  </h4>
<p>Reports the highest value in the given raster dataset.</p>
</div>
<div class="dict_entry" id="gis:maximum-of">
  <h3><a>gis:maximum-of</a></h3>
  <h4>
    <span class="prim_example">gis:maximum-of <i>RasterDataset</i></span>
  </h4>
<p>Reports the lowest value in the given raster dataset.</p>
</div>
<div class="dict_entry" id="gis:sampling-method-of">
  <h3><a>gis:sampling-method-of</a></h3>
  <h4>
    <span class="prim_example">gis:sampling-method-of <i>RasterDataset</i></span>
  </h4>
<p>Reports the sampling method used to compute the value of the given
raster dataset at a single point, or over an area smaller than a
single raster cell. Sampling is performed by the GIS extension
primitives <a href="#gis:raster-sample">raster-sample</a>, <a href="#gis:resample">resample</a>, <a href="#gis:convolve">convolve</a>,
and <a href="#gis:apply-raster">apply-raster</a>. The sampling
method will be one of the following:</p>
<ul>
<li><code>&quot;NEAREST_NEIGHBOR&quot;</code>: the value of the cell
nearest the sampling location is used.</li>
<li><code>&quot;BILINEAR&quot;</code>: the value of the four nearest
cells are sampled by linear weighting, according to their
proximity to the sampling site.</li>
<li><code>&quot;BICUBIC&quot;</code>: the value of the sixteen nearest
cells are sampled, and their values are combined by weight
according to a piecewise cubic polynomial recommended by Rifman
(see <em>Digital Image Warping</em>, George Wolberg, 1990, pp
129-131, IEEE Computer Society Press).</li>
<li><code>&quot;BICUBIC_2&quot;</code>: the value is sampled using the
same procedure and the same polynomial as with <code>BICUBIC</code>
above, but using a different coefficient. This method may produce
somewhat sharper results than <code>BICUBIC</code>, but that result
is data dependent.</li>
</ul>
<p>For more information on these sampling methods and on raster
sampling in general, see <a href="http://en.wikipedia.org/wiki/Image_scaling" target="_blank">this wikipedia
article</a>.</p>
</div>
<div class="dict_entry" id="gis:set-sampling-method">
  <h3><a>gis:set-sampling-method</a></h3>
  <h4>
    <span class="prim_example">gis:set-sampling-method <i>RasterDataset</i> <i>sampling-method</i></span>
  </h4>
<p>Sets the sampling method used by the given raster dataset at a
single point, or over an area smaller than a single raster cell.
Sampling is performed by the GIS extension primitives <a href="#gis:raster-sample">raster-sample</a>, <a href="#gis:resample">resample</a>, <a href="#gis:convolve">convolve</a>,
and <a href="#gis:apply-raster">apply-raster</a>. The sampling
method must be one of the following:</p>
<ul>
<li><code>&quot;NEAREST_NEIGHBOR&quot;</code></li>
<li><code>&quot;BILINEAR&quot;</code></li>
<li><code>&quot;BICUBIC&quot;</code></li>
<li><code>&quot;BICUBIC_2&quot;</code></li>
</ul>
<p>See <a href="#gis:sampling-method-of">sampling-method-of</a> above
for a more specific description of each sampling method.</p>
</div>
<div class="dict_entry" id="gis:raster-sample">
  <h3><a>gis:raster-sample</a></h3>
  <h4>
    <span class="prim_example">gis:raster-sample <i>RasterDataset</i> <i>sample-location</i></span>
  </h4>
<p>Reports the value of the given raster over the given location. The
location may be any of the following:</p>
<ul>
<li>A list of length 2, which is taken to represent a point in
netlogo space (<code>[xcor ycor]</code>) of the sort reported by
<a href="#gis:location-of">location-of</a> Vertex. The raster
dataset is sampled at the point of that location.</li>
<li>A list of length 4, which is taken to represent an envelope in
GIS space, of the sort reported by <a href="#gis:envelope-of">envelope-of</a>. The raster dataset is sampled
over the area of that envelope.</li>
<li>A patch, in which case the raster dataset is sampled over the
area of the patch.</li>
<li>A turtle, in which case the raster dataset is sampled at the
location of that turtle.</li>
<li>A Vertex, in which case the raster dataset is sampled at the
location of that Vertex.</li>
</ul>
<p>If the requested location is outside the area covered by the raster
dataset, this primitive reports the special value representing
&ldquo;not a number&rdquo;, which is printed by NetLogo as
&ldquo;NaN&rdquo;. Using the special &ldquo;not a number&rdquo; value
as an argument to primitives that expect a number may cause an
error, but you can test the value reported by this primitive to
filter out &ldquo;not a number&rdquo; values. A value that is not a
number will be neither less than nor greater than a number value,
so you can detect &ldquo;not a number&rdquo; values using the
following:</p>
<pre><code>let value gis:raster-sample dataset turtle 0
; set color to blue if value is a number, red if value is &quot;not a number&quot;
ifelse (value &lt;= 0) or (value &gt;= 0)
[ set color blue ]
[ set color red ]
</code></pre>
<p>If the requested location is a point, the sample is always computed
using the method set by <a href="#gis:set-sampling-method">set-sampling-method</a>. If the
requested location is an area (i.e., an envelope or patch), the
sample is computed by taking the average of all raster cells
covered by the requested area.</p>
</div>
<div class="dict_entry" id="gis:raster-world-envelope">
  <h3><a>gis:raster-world-envelope</a></h3>
  <h4>
    <span class="prim_example">gis:raster-world-envelope <i>RasterDataset</i> <i>x</i> <i>y</i></span>
  </h4>
<p>Reports the GIS envelope needed to match the boundaries of NetLogo
patches with the boundaries of cells in the given raster dataset.
This envelope could then be used as an argument to <a href="#gis:set-transformation-ds">set-transformation-ds</a>.</p>
<p>There may be more cells in the dataset than there are patches in
the NetLogo world. In that case, you will need to select a subset
of cells in the dataset by specifying which cell in the dataset you
want to match with the upper-left corner of the NetLogo world.
Cells are numbered from left to right, and from top to bottom,
beginning with zero. So the upper left cell is (0, 0), and the
bottom right cell is (<code>gis:width-of dataset</code> - 1, <code>gis:height-of dataset</code> - 1).</p>
</div>
<div class="dict_entry" id="gis:create-raster">
  <h3><a>gis:create-raster</a></h3>
  <h4>
    <span class="prim_example">gis:create-raster <i>width</i> <i>height</i> <i>envelope</i></span>
  </h4>
<p>Creates and reports a new, empty raster dataset with the given
number of columns and rows, covering the given envelope.</p>
</div>
<div class="dict_entry" id="gis:resample">
  <h3><a>gis:resample</a></h3>
  <h4>
    <span class="prim_example">gis:resample <i>RasterDataset</i> <i>envelope</i> <i>width</i> <i>height</i></span>
  </h4>
<p>Reports a new dataset that consists of the given RasterDataset
resampled to cover the given envelope and to contain the given
number of columns and rows. If the new raster&rsquo;s cells are
smaller than the existing raster&rsquo;s cells, they will be
resampled using the method set by <a href="#gis:set-sampling-method">set-sampling-method</a>. If the new
cells are larger than the original cells, they will be sampled
using the <code>&quot;NEAREST_NEIGHBOR&quot;</code> method.</p>
</div>
<div class="dict_entry" id="gis:convolve">
  <h3><a>gis:convolve</a></h3>
  <h4>
    <span class="prim_example">gis:convolve <i>RasterDataset</i> <i>kernel-rows</i> <i>kernel-columns</i> <i>kernel</i> <i>key-column</i> <i>key-row</i></span>
  </h4>
<p>Reports a new raster whose data consists of the given raster
convolved with the given kernel.</p>
<p>A convolution is a mathematical operation that computes each output
cell by multiplying elements of a kernel with the cell values
surrounding a particular source cell. A kernel is a matrix of
values, with one particular value defined as the &ldquo;key
element&rdquo;, the value that is centered over the source cell
corresponding to the destination cell whose value is being
computed.</p>
<p>The values of the kernel matrix are given as a list, which
enumerates the elements of the matrix from left to right, top to
bottom. So the elements of a 3-by-3 matrix would be listed in the
following order:
<table width="25%" border="1" style="text-align: center; margin: 0 auto;" align="center"></p>
<tr>
  <td> 1 <td> 2 <td> 3 <tr>
  <td> 4 <td> 5 <td> 6 <tr>
  <td> 7 <td> 8 <td> 9 </table>
<p>The key element is specified by column and row within the matrix.
Columns are numbered from left to right, beginning with zero. Rows
are numbered from top to bottom, also beginning with zero. So, for
example, the kernel for the horizontal <a href="http://en.wikipedia.org/wiki/Sobel_operator" target="_blank">Sobel operator</a>,
which looks like this:
<table width="25%" border="1" style="text-align: center; margin: 0 auto;" align="center"></p>
<tr>
  <td> 1 <td> 0 <td> -1 <tr>
  <td> 2 <td> 0 <br> <small>(key)</small> <td> -2 <tr>
  <td> 1 <td> 0 <td> -1 </table>
<p>would be specified as follows:</p>
<pre><code>let horizontal-gradient gis:convolve dataset 3 3 [1 0 -1 2 0 -2 1 0 -1] 1 1
</code></pre>
</div>
<div class="dict_entry" id="gis:apply-raster">
  <h3><a>gis:apply-raster</a></h3>
  <h4>
    <span class="prim_example">gis:apply-raster <i>RasterDataset</i> <i>patch-variable</i></span>
  </h4>
<p>Copies values from the given raster dataset to the given patch
variable, resampling the raster as necessary so that its cell
boundaries match up with NetLogo patch boundaries. This resampling
is done as if using <a href="#gis:resample">resample</a> rather
than <a href="#gis:raster-sample">raster-sample</a>, for the sake
of efficiency. However, patches not covered by the raster are
assigned values of &ldquo;not a number&rdquo; in the same way that
<a href="#gis:raster-sample">raster-sample</a> reports values for
locations outside the raster.</p>
</div>
<div class="dict_entry" id="gis:drawing-color">
  <h3><a>gis:drawing-color</a></h3>
  <h4>
    <span class="prim_example">gis:drawing-color</span>
  </h4>
<p>Reports the color used by the GIS extension to draw vector features
into the NetLogo drawing layer. Color can be represented either as
a NetLogo color (a single number between zero and 140) or an RGB
color (a list of 3 numbers). See details in the <a href="programming.html#colors">Colors</a> section of the
Programming Guide.</p>
</div>
<div class="dict_entry" id="gis:set-drawing-color">
  <h3><a>gis:set-drawing-color</a></h3>
  <h4>
    <span class="prim_example">gis:set-drawing-color <i>color</i></span>
  </h4>
<p>Sets the color used by the GIS extension to draw vector features
into the NetLogo drawing layer. <em>Color</em> can be represented
either as a NetLogo color (a single number between zero and 140) or
an RGB color (a list of 3 numbers). See details in the <a href="programming.html#colors">Colors</a> section of the Programming Guide.</p>
</div>
<div class="dict_entry" id="gis:draw">
  <h3><a>gis:draw</a></h3>
  <h4>
    <span class="prim_example">gis:draw <i>vector-data</i> <i>line-thickness</i></span>
  </h4>
<p>Draws the given vector data to the NetLogo drawing layer, using the
current GIS drawing color, with the given line thickness. The data
may consist either of an entire VectorDataset, or a single
VectorFeature. This primitive draws only the boundary of polygon
data, and for point data, it fills a circle with a radius equal to
the line thickness.</p>
</div>
<div class="dict_entry" id="gis:fill">
  <h3><a>gis:fill</a></h3>
  <h4>
    <span class="prim_example">gis:fill <i>vector-data</i> <i>line-thickness</i></span>
  </h4>
<p>Fills the given vector data in the NetLogo drawing layer using the
current GIS drawing color, using the given line thickness around
the edges. The data may consist either of an entire VectorDataset,
or a single VectorFeature. For point data, it fills a circle with a
radius equal to the line thickness.</p>
</div>
<div class="dict_entry" id="gis:paint">
  <h3><a>gis:paint</a></h3>
  <h4>
    <span class="prim_example">gis:paint <i>RasterDataset</i> <i>transparency</i></span>
  </h4>
<p>Paints the given raster data to the NetLogo drawing layer. The
highest value in the dataset is painted white, the lowest is
painted in black, and the other values are painted in shades of
gray scaled linearly between white and black.</p>
<p>The <em>transparency</em> input determines how transparent the new
image in the drawing will be. Valid inputs range from 0 (completely
opaque) to 255 (completely transparent).</p>
</div>
<div class="dict_entry" id="gis:import-wms-drawing">
  <h3><a>gis:import-wms-drawing</a></h3>
  <h4>
    <span class="prim_example">gis:import-wms-drawing <i>server-url</i> <i>spatial-reference</i> <i>layers</i> <i>transparency</i></span>
  </h4>
<p>Imports an image into the NetLogo drawing layer using the
<a href="http://www.opengeospatial.org/standards/wms" target="_blank">Web Mapping Service</a>
protocol, as defined by the <a href="http://www.opengeospatial.org/" target="_blank">
Open Geospatial Consortium</a>.</p>
<p>The <em>spatial reference</em> and <em>layers</em> inputs should be
given as strings. The <em>spatial reference</em> input corresponds to
the <strong>SRS</strong> parameter to the <strong>GetMap</strong> request as defined in
section 7.2.3.5 of version 1.1.1 of the WMS standard. The
<em>layers</em> input corresponds to the <strong>LAYERS</strong> parameter to
the as defined in 7.2.3.3 of version 1.1.1 of the WMS standard.</p>
<p>You can find the list of valid spatial reference codes and layer
names by examining the response to a <strong>GetCapabilities</strong> request
to the WMS server. Consult the relevant standard for instructions
on how to issue a <strong>GetCapabilities</strong> request to the server and
how to interpret the results.</p>
<p>The <em>transparency</em> input determines how transparent the new
image in the drawing will be. Valid inputs range from 0 (completely
opaque) to 255 (completely transparent).</p>
</div>
